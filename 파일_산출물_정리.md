# RAGAS í‰ê°€ ì‹œìŠ¤í…œ - ê° ì§ˆì˜ë³„ ì‚°ì¶œë¬¼ ë° ê²°ê³¼ë¬¼ ì •ë¦¬

## ê°œìš”
í‰ê°€ í”„ë¡œì„¸ìŠ¤ëŠ” í¬ê²Œ **3ë‹¨ê³„**ë¡œ ì§„í–‰ë˜ë©°, ê° ë‹¨ê³„ì—ì„œ ì—¬ëŸ¬ íŒŒì¼ì´ ìƒì„±ë©ë‹ˆë‹¤.

---

## ğŸ“Š ë‹¨ê³„ë³„ ì‚°ì¶œë¬¼ í‘œ

### 1ë‹¨ê³„: ë°ì´í„° ìˆ˜ì§‘ (Data Collection)
ê° ì§ˆì˜(query)ë§ˆë‹¤ ì‹¤í–‰ë˜ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤.

| ìˆœì„œ | íŒŒì¼ëª… íŒ¨í„´ | ì €ì¥ ìœ„ì¹˜ | íŒŒì¼ í˜•ì‹ | ë‚´ìš© | ì €ì¥ ì‹œê¸° | ë³´ê´€ ê¸°ê°„ |
|------|------------|-----------|-----------|------|-----------|-----------|
| 1 | `payload_{timestamp}_{uuid}.json` | `{temp_dir}/payloads/` | JSON | Langflow API ìš”ì²­ìš© payload (query í¬í•¨) | ì§ˆì˜ë³„ ì¦‰ì‹œ | ì„ì‹œ(í‰ê°€ ì™„ë£Œ í›„ ì‚­ì œ) |
| 2 | `response_{timestamp}_{uuid}.json` | `data/responses/` | JSON | Langflow API ì‘ë‹µ ì „ì²´ (íƒ€ì„ìŠ¤íƒ¬í”„, URL, payload, response í¬í•¨) | ì§ˆì˜ë³„ ì¦‰ì‹œ | **ì˜êµ¬ ë³´ê´€** |
| 3 | `parsed_{timestamp}_{uuid}.json` | `{temp_dir}/parsed_responses/` | JSON | íŒŒì‹±ëœ ì‘ë‹µ (answer, contextë§Œ ì¶”ì¶œ) | ì§ˆì˜ë³„ ì¦‰ì‹œ | ì„ì‹œ(í‰ê°€ ì™„ë£Œ í›„ ì‚­ì œ) |

**ìƒì„± í•¨ìˆ˜**: `collect_query_data()` (app.py:55-130)

---

### 2ë‹¨ê³„: í‰ê°€ ì‹¤í–‰ (Evaluation)
ëª¨ë“  ì§ˆì˜ì˜ ë°ì´í„° ìˆ˜ì§‘ì´ ì™„ë£Œëœ í›„ **ë°°ì¹˜ë¡œ ì‹¤í–‰**ë©ë‹ˆë‹¤.

| ìˆœì„œ | íŒŒì¼ëª… íŒ¨í„´ | ì €ì¥ ìœ„ì¹˜ | íŒŒì¼ í˜•ì‹ | ë‚´ìš© | ì €ì¥ ì‹œê¸° | ë³´ê´€ ê¸°ê°„ |
|------|------------|-----------|-----------|------|-----------|-----------|
| 4 | `ragas_results_{timestamp}.json` | `{temp_dir}/results/` | JSON | í‰ê°€ ê²°ê³¼ (faithfulness, answer_relevancy, context_precision, context_recall) + ì…ë ¥ ë°ì´í„° + ì‘ë‹µ ë°ì´í„° | í‰ê°€ ì™„ë£Œ í›„ ì§ˆì˜ë³„ | ì„ì‹œ(í‰ê°€ ì™„ë£Œ í›„ ì‚­ì œ) |
| 5 | `ragas_results_{timestamp}.jpg` | `{temp_dir}/results/` | JPG | í‰ê°€ ê²°ê³¼ ì‹œê°í™” ì°¨íŠ¸ (ë©”íŠ¸ë¦­ë³„ ì ìˆ˜ ë§‰ëŒ€ ê·¸ë˜í”„) | í‰ê°€ ì™„ë£Œ í›„ ì§ˆì˜ë³„ | ì„ì‹œ(í‰ê°€ ì™„ë£Œ í›„ ì‚­ì œ) |

**ìƒì„± í•¨ìˆ˜**: `save_evaluation_results()` (ragasEvaluator.py:202-254)

**ì°¸ê³ **: 
- í‰ê°€ì—ì„œ ì œì™¸ëœ ì§ˆì˜(ë‹µë³€ì´ ì—†ê±°ë‚˜ contextê°€ null)ëŠ” ê²°ê³¼ íŒŒì¼ì´ ìƒì„±ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
- ì‹¤íŒ¨í•œ ì§ˆì˜ëŠ” ê²°ê³¼ íŒŒì¼ì´ ìƒì„±ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

---

### 3ë‹¨ê³„: ìµœì¢… ê²°ê³¼ ì••ì¶• (Final Archive)
ëª¨ë“  í‰ê°€ê°€ ì™„ë£Œëœ í›„ **1íšŒë§Œ ì‹¤í–‰**ë©ë‹ˆë‹¤.

| ìˆœì„œ | íŒŒì¼ëª… íŒ¨í„´ | ì €ì¥ ìœ„ì¹˜ | íŒŒì¼ í˜•ì‹ | ë‚´ìš© | ì €ì¥ ì‹œê¸° | ë³´ê´€ ê¸°ê°„ |
|------|------------|-----------|-----------|------|-----------|-----------|
| 6 | `ragas_results_{timestamp}_{uuid}.zip` | `{temp_dir.parent}/` (ì‹œìŠ¤í…œ ì„ì‹œ ë””ë ‰í† ë¦¬) | ZIP | ëª¨ë“  ì‚°ì¶œë¬¼ ë° ê²°ê³¼ë¬¼ ì••ì¶• íŒŒì¼ | í‰ê°€ ì™„ë£Œ í›„ 1íšŒ | ì„¸ì…˜ ìƒíƒœì— ì¶”ì  (ì¶”í›„ ì •ë¦¬ ê°€ëŠ¥) |

**ZIP íŒŒì¼ êµ¬ì¡°**:
```
ragas_results_20260115_123456_abcd1234.zip
â”œâ”€â”€ results/
â”‚   â”œâ”€â”€ ragas_results_20260115_123001_001.json  (í‰ê°€ ê²°ê³¼ JSON)
â”‚   â”œâ”€â”€ ragas_results_20260115_123001_001.jpg   (í‰ê°€ ê²°ê³¼ ì°¨íŠ¸)
â”‚   â”œâ”€â”€ ragas_results_20260115_123002_002.json
â”‚   â”œâ”€â”€ ragas_results_20260115_123002_002.jpg
â”‚   â””â”€â”€ ... (ì§ˆì˜ë³„ ê²°ê³¼ íŒŒì¼ë“¤)
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ responses/
â”‚   â”‚   â”œâ”€â”€ response_20260115_123001_a1b2c3d4.json  (ì˜êµ¬ ì €ì¥ëœ ì‘ë‹µ)
â”‚   â”‚   â”œâ”€â”€ response_20260115_123002_e5f6g7h8.json
â”‚   â”‚   â””â”€â”€ ... (ì§ˆì˜ë³„ ì‘ë‹µ íŒŒì¼ë“¤)
â”‚   â”œâ”€â”€ payloads/
â”‚   â”‚   â”œâ”€â”€ payload_20260115_123001_i9j0k1l2.json  (ì„ì‹œ ì €ì¥ëœ payload)
â”‚   â”‚   â””â”€â”€ ... (ì§ˆì˜ë³„ payload íŒŒì¼ë“¤)
â”‚   â””â”€â”€ parsed_responses/
â”‚       â”œâ”€â”€ parsed_20260115_123001_m3n4o5p6.json  (ì„ì‹œ ì €ì¥ëœ íŒŒì‹± ê²°ê³¼)
â”‚       â””â”€â”€ ... (ì§ˆì˜ë³„ íŒŒì‹± ê²°ê³¼ íŒŒì¼ë“¤)
```

**ìƒì„± í•¨ìˆ˜**: `create_zip_file()` (app.py:194-233)

---

## ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡° ìš”ì•½

### ì˜êµ¬ ì €ì¥ (ë³´ì¡´)
- `data/responses/` - Langflow API ì‘ë‹µ (ì˜êµ¬ ë³´ê´€)
  - ì˜ˆ: `response_20260115_123001_a1b2c3d4.json`

### ì„ì‹œ ì €ì¥ (í‰ê°€ ì™„ë£Œ í›„ ìë™ ì‚­ì œ)
- `{temp_dir}/payloads/` - Payload íŒŒì¼ë“¤
- `{temp_dir}/parsed_responses/` - íŒŒì‹±ëœ ì‘ë‹µë“¤
- `{temp_dir}/results/` - í‰ê°€ ê²°ê³¼ JSON ë° JPG

### ìµœì¢… ì‚°ì¶œë¬¼
- `{temp_dir.parent}/ragas_results_*.zip` - ëª¨ë“  ê²°ê³¼ ì••ì¶• íŒŒì¼

---

## ğŸ”„ í”„ë¡œì„¸ìŠ¤ íë¦„ë„

```
ì§ˆì˜ 1 â†’ [Payload ìƒì„±] â†’ [API ìš”ì²­] â†’ [Response ì €ì¥(ì˜êµ¬)] â†’ [íŒŒì‹±] â†’ [Parsed ì €ì¥]
ì§ˆì˜ 2 â†’ [Payload ìƒì„±] â†’ [API ìš”ì²­] â†’ [Response ì €ì¥(ì˜êµ¬)] â†’ [íŒŒì‹±] â†’ [Parsed ì €ì¥]
...
ì§ˆì˜ N â†’ [Payload ìƒì„±] â†’ [API ìš”ì²­] â†’ [Response ì €ì¥(ì˜êµ¬)] â†’ [íŒŒì‹±] â†’ [Parsed ì €ì¥]
                â†“
        [ë°°ì¹˜ í‰ê°€ ì‹¤í–‰] â†’ [ê²°ê³¼ JSON/JPG ìƒì„±] (ì§ˆì˜ë³„)
                â†“
        [ZIP íŒŒì¼ ìƒì„±] â†’ [ë‹¤ìš´ë¡œë“œ ì œê³µ]
                â†“
        [ì„ì‹œ ë””ë ‰í† ë¦¬ ì •ë¦¬] (ìë™ ì‚­ì œ)
```

---

## ğŸ’¾ ê° ì§ˆì˜ë³„ ìµœì¢… ì‚°ì¶œë¬¼ ìš”ì•½

í‰ê°€ì— ì„±ê³µí•œ ì§ˆì˜ 1ê°œë‹¹ **5ê°œ íŒŒì¼** ìƒì„±:

1. âœ… `payload_{timestamp}_{uuid}.json` (ì„ì‹œ)
2. âœ… `response_{timestamp}_{uuid}.json` (**ì˜êµ¬ ë³´ê´€**)
3. âœ… `parsed_{timestamp}_{uuid}.json` (ì„ì‹œ)
4. âœ… `ragas_results_{timestamp}.json` (ì„ì‹œ)
5. âœ… `ragas_results_{timestamp}.jpg` (ì„ì‹œ)

+ **ì „ì²´ í‰ê°€ ì„¸ì…˜ë‹¹ 1ê°œ**:
6. âœ… `ragas_results_{timestamp}_{uuid}.zip` (ìµœì¢… ì••ì¶• íŒŒì¼)

---

## ğŸ“ ì°¸ê³  ì‚¬í•­

### íŒŒì¼ëª… í˜•ì‹
- **íƒ€ì„ìŠ¤íƒ¬í”„**: `YYYYMMDD_HHMMSS_ffffff` (ë…„ì›”ì¼_ì‹œë¶„ì´ˆ_ë§ˆì´í¬ë¡œì´ˆ)
- **UUID**: 8ìë¦¬ 16ì§„ìˆ˜ (ì¤‘ë³µ ë°©ì§€)
- **ì˜ˆì‹œ**: `response_20260115_123456_789012_a1b2c3d4.json`

### ì˜ˆì™¸ ì²˜ë¦¬
- **ì‹¤íŒ¨í•œ ì§ˆì˜**: Payloadì™€ Response íŒŒì¼ë§Œ ìƒì„± (í‰ê°€ ê²°ê³¼ ì—†ìŒ)
- **ì œì™¸ëœ ì§ˆì˜**: Payload, Response, Parsed íŒŒì¼ì€ ìƒì„±ë˜ì§€ë§Œ í‰ê°€ ê²°ê³¼ íŒŒì¼ì€ ì—†ìŒ
  - ì œì™¸ ì‚¬ìœ : ë‹µë³€ì´ ì—†ê±°ë‚˜ contextê°€ null

### ì •ë¦¬ ì •ì±…
- **ì„ì‹œ ë””ë ‰í† ë¦¬**: `finally` ë¸”ë¡ì—ì„œ ìë™ ì‚­ì œ (í‰ê°€ ì™„ë£Œ/ì˜¤ë¥˜ ì‹œ)
- **ZIP íŒŒì¼**: ì„¸ì…˜ ìƒíƒœì— ê²½ë¡œ ì €ì¥ (ì¶”í›„ ì •ë¦¬ ê°€ëŠ¥)
- **ì˜êµ¬ ì €ì¥ íŒŒì¼**: ìˆ˜ë™ ì •ë¦¬ ë˜ëŠ” ë³„ë„ ì •ì±… í•„ìš”

---

## ğŸ“Œ ì£¼ìš” ì½”ë“œ ìœ„ì¹˜

| ê¸°ëŠ¥ | íŒŒì¼ | í•¨ìˆ˜/ìœ„ì¹˜ |
|------|------|-----------|
| Payload ì €ì¥ | `askToLangflow.py` | `save_payload()` |
| Response ì €ì¥ | `askToLangflow.py` | `save_response()` |
| Parsed ì €ì¥ | `responseParser.py` | `save_parsed_response()` |
| í‰ê°€ ê²°ê³¼ ì €ì¥ | `ragasEvaluator.py` | `save_evaluation_results()` |
| ZIP ìƒì„± | `app.py` | `create_zip_file()` |
| ì„ì‹œ ë””ë ‰í† ë¦¬ ì •ë¦¬ | `app.py` | `finally` ë¸”ë¡ (main í•¨ìˆ˜) |
